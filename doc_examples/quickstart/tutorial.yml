bootstrap: |
  pavex new demo && cd demo && cargo fmt && git add . && git commit -m "Initial commit"
starter_project_folder: demo
snippets:
  - name: "blueprint_definition"
    source_path: "demo/src/blueprint.rs"
    ranges: [ "6..15" ]
  - name: "route_registration"
    source_path: "demo/src/blueprint.rs"
    ranges: [ "6..15" ]
    hl_lines: [ 7 ]
  - name: "ping_handler"
    source_path: "demo/src/routes/status.rs"
    ranges: [ ".." ]
steps:
  - patch: "02.patch"
    snippets:
      - name: "new_submodule"
        source_path: "demo/src/routes/mod.rs"
        ranges: [ ".." ]
        hl_lines: [ 1 ]
      - name: "route_def"
        source_path: "demo/src/routes/greet.rs"
        ranges: [ ".." ]
      - name: "register_new_route"
        source_path: "demo/src/blueprint.rs"
        ranges: [ "6..19" ]
        hl_lines: [ 8, 9, 10, 11, 12 ]
  - patch: "03.patch"
    snippets:
      - name: "route_def"
        source_path: "demo/src/routes/greet.rs"
        ranges: [ ".." ]
  - patch: "04.patch"
    snippets:
      - name: "route_def"
        source_path: "demo/src/routes/greet.rs"
        ranges: [ ".." ]
      - name: "register_common_invocation"
        source_path: "demo/src/blueprint.rs"
        ranges: [ "6..9", "18..20" ]
        hl_lines: [ 3 ]
      - name: "route_params_constructor"
        source_path: "demo/src/blueprint.rs"
        ranges: [ "22..23", "33..37", "60..61" ]
        hl_lines: [ 3, 4, 5, 6 ]
  - patch: "05.patch"
    snippets:
      - name: "new_submodule"
        source_path: "demo/src/lib.rs"
        ranges: [ ".." ]
        hl_lines: [ 7 ]
      - name: "user_agent"
        source_path: "demo/src/user_agent.rs"
        ranges: [ ".." ]
      - name: "inject"
        source_path: "demo/src/routes/greet.rs"
        ranges: [ "3..4", "10..16", "20..21" ]
        hl_lines: [ 3 ]
  - patch: "05-bis.patch"
  #    commands:
  #      - command: "cargo px c -q"
  #        expected_outcome: "failure"
  #        expected_output_at: "05-error.snap"
  - patch: "06.patch"
  - patch: "07.patch"
  #    commands:
  #      - command: "cargo px c -q"
  #        expected_outcome: "failure"
  #        expected_output_at: "07-error.snap"
  - patch: "08.patch"
  - patch: "09.patch"
  - patch: "10.patch"
